# Epic 2 Retrospective — Project & Workflow State Visualization

**Date:** 2026-02-02
**Facilitator:** Bob (Scrum Master)
**Participants:** Alice (Product Owner), Bob (SM), Charlie (Senior Dev), Dana (QA Engineer), Elena (Junior Dev), Flow (Project Lead)

---

## Epic Summary

| Metric | Value |
| --- | --- |
| Epic | 2 — Project & Workflow State Visualization |
| Stories Completed | 5/5 (100%) |
| FRs Covered | FR1, FR2, FR4, FR5 |
| Tests (start → end) | 64 → 213 (149 new, zero regressions) |
| Code Review Findings | ~35 total (1 CRITICAL, ~18 HIGH, ~11 MEDIUM, ~5 LOW) |
| All Findings Resolved | Yes (except 2 LOW deferred) |
| Production Incidents | 0 (not yet deployed) |
| Agent Model | Claude Opus 4.5 (all stories) |
| Code Reviewers | Opus + Gemini (dual-model parallel, all stories) |

## Stories Delivered

| Story | Title | Highlights |
| --- | --- | --- |
| 2-1 | Project Open & BMAD Config Loading | Full-stack: Tauri dialog, ProjectManager, dynamic service lifecycle, WebSocket service, shared apiFetch extraction. 27 files, 64 tests. |
| 2-2 | Workflow State Visualization | Frontend: Signal state layer, workflow-status-display component, WebSocket event wiring. CRITICAL review finding (fake workflow grouping). 96 tests. |
| 2-3 | Phase Graph Container Component | Frontend + backend fixes: HTML/CSS hybrid architecture (HTML nodes + SVG edges), CSS Grid layout, keyboard navigation, compact mode. 141 tests. |
| 2-4 | Phase Node Component | Frontend refactor: Extracted `<phase-node>`, added locked state, dependency computation, human-readable labels, enhanced tooltips. Shoelace infrastructure fixes bundled. 194 tests. |
| 2-5 | App Shell & Layout | Frontend: `<activity-bar>` component, horizontal layout refactor, section switching, Cmd+1/2/3 keyboard shortcuts. 213 tests. |

## Successes

1. **100% story completion** — All 5 stories delivered with comprehensive test coverage
2. **HTML/CSS hybrid architecture** — Elegant phase graph with CSS Grid + SVG overlay, zero external graph library dependencies
3. **Pattern reuse accelerated velocity** — apiFetch, signal state, service layer, SignalWatcher mixin established once and reused across all stories
4. **Dual-model review (Opus + Gemini)** — Continued from Epic 1, caught CRITICAL fake workflow grouping in 2.2 and ~18 HIGH issues across all stories
5. **Code-simplifier between stories** — Kept codebase lean throughout the epic (documented runs on 2.2, 2.3, 2.4)
6. **Bugs caught on the fly** — Backend service bugs from Epic 0 surfaced and fixed during real-world exercise of the full pipeline
7. **Test trajectory** — Steady growth from 64 to 213 with zero regressions across all 5 stories
8. **Manual testing** — Flow tested the running app, catching additional backend and frontend bugs inline

## Challenges

1. **Accessibility implemented but not verified on first pass** — Stories 2.3, 2.4, 2.5 all had accessibility fixes (ARIA attributes, keyboard nav, focus management) caught in code review rather than initial implementation. Accepted as iterative — review process catches gaps.
2. **CRITICAL data honesty issue in Story 2.2** — Fake `_getWorkflowsForPhase` hack dumped all workflows under Phase 1. Caught and fixed by dual-model review.
3. **Undocumented backend changes in Story 2.3** — Four backend files modified but not listed in File List until code review caught the omission.
4. **Test environment friction** — ResizeObserver loop errors (2.3), ES module read-only exports (2.2), CSS custom properties not resolving (2.5). Workarounds in place but recurring pattern.
5. **Integration wiring gaps** — WebSocket not connected after project open (2.1), event handlers not registered (2.2) — caught in review.

## Key Insights

1. **Pattern reuse is the velocity multiplier** — Each pattern established once, reused across all stories. Epic 3 should benefit from the same acceleration with streaming patterns once Story 3.1 establishes them.
2. **Dual-model review is proven standard practice** — Caught CRITICAL and HIGH issues across 2 epics. Non-negotiable going forward.
3. **Earlier epic services reveal bugs under real load** — Epic 0 services had latent issues only surfacing when Epic 2 exercised the full pipeline. Expect the same for Epic 3 with WebSocket streaming.
4. **Research before building pays off** — Three research spikes identified for Epic 3 to prevent architectural guesswork.
5. **Accessibility is iterative** — The review process catches gaps, which is the system working as intended.

## Code Review Pattern Analysis

| Category | Frequency | Examples |
| --- | --- | --- |
| Accessibility gaps | 3/5 stories | Missing ARIA attributes (2.3), aria-disabled binding (2.4), roving tabindex (2.5) |
| Data honesty / correctness | 2/5 stories | Fake workflow grouping (2.2 CRITICAL), LoadingState inconsistency (2.2) |
| Performance / efficiency | 2/5 stories | Repeated signal reads (2.3), O(N) DOM queries (2.3), missing debounce (2.2) |
| Integration wiring | 2/5 stories | WebSocket not connected (2.1), event handlers not registered (2.2) |
| Undocumented changes | 1/5 stories | Backend files not in File List (2.3) |
| Security / hardening | 1/5 stories | MaxBytesReader on POST body (2.1), filepath.Abs sanitization (2.1) |

## Previous Retrospective Follow-Through (Epic 1)

| # | Action | Status | Evidence |
| --- | --- | --- | --- |
| 1 | Continue dual-model parallel review (Opus + Gemini) | ✅ Completed | All 5 stories reviewed with Opus + Gemini |
| 2 | Continue code-simplifier between stories AND on epic PR | ✅ Completed | Documented runs on Stories 2.2, 2.3, 2.4 |
| 6 | Auto-documentation on PR merges | ⏳ Backlog | Deferred to after Epic 3 (still appropriate) |
| 7 | Formalize code-simplifier as automated hook | ⏳ Backlog | Deferred to after Epic 3 |

**Result:** 6/8 completed or on-track (same rate as Epic 1). Team is consistent on follow-through.

## Technical Debt Carried Forward

| # | Item | Priority | Source | Notes |
| --- | --- | --- | --- | --- |
| 1 | Asymmetric error mapper naming | Low | Epic 1, Story 1-4 | Not blocking, cosmetic |
| 2 | `start` chunk missing `Model` field | Low | Epic 1, Story 1-4 | Address in Epic 3 (streaming) |
| 3 | `ListModels()` error return unused | Low | Epic 1, Story 1-4 | Accepted interface design |
| 4 | `isTimeout()` helper naming | Low | Epic 1, Story 1-5 | Revisit if more providers added |
| 5 | Story status file inconsistencies (2-1, 2-3 say "review") | Low | Epic 2 | Align story files with sprint-status |
| 6 | WebSocket test too shallow (2.2) | Low | Epic 2, Story 2-2 | Tests call function directly instead of simulating event dispatch |

None of these are blocking for Epic 3.

## Action Items

### Process Improvements

| # | Action | Owner | Success Criteria |
| --- | --- | --- | --- |
| 1 | Continue dual-model parallel review (Opus + Gemini) | Flow | Every story gets at least one dual-model review pass |
| 2 | Continue code-simplifier between stories AND on epic PR | Flow | Simplifier runs between stories and before epic merge |

### Housekeeping

| # | Action | Owner | Status |
| --- | --- | --- | --- |
| 3 | Fix story status inconsistencies (2-1, 2-3 → done) | Bob (SM) | Pending |
| 4 | Update sprint-status: Epic 2 → done | Bob (SM) | Done (this retro) |
| 5 | Update sprint-status: epic-2-retrospective → done | Bob (SM) | Done (this retro) |

### Future Backlog (Carried from Epic 1)

| # | Item | Notes |
| --- | --- | --- |
| 6 | Auto-documentation on PR merges | Revisit after Epic 3 |
| 7 | Formalize code-simplifier as automated hook | Revisit after Epic 3 |

## Epic 3 Preparation Tasks

### Research Spikes (Critical — before Epic 3 starts)

| # | Task | Owner | Output | Success Criteria |
| --- | --- | --- | --- | --- |
| 1 | Research streaming conventions (Automaker.app, T3Chat, similar projects) | Charlie (Senior Dev) / Flow | Technical decision document | Clear architectural decision on chat WebSocket approach (same connection vs separate, chunk protocol, session scoping) |
| 2 | Research Claude API access model (subscription reuse vs API-key-only) | Alice (Product Owner) / Flow | Product decision on supported auth models | Clear answer on whether to support subscription-based access |
| 3 | Ollama integration test setup (local model for streaming tests) | Dana (QA Engineer) / Flow | Working test harness + documentation | Can run real end-to-end streaming test locally without API costs |

### Critical Path

All three research spikes must complete before Epic 3's Story 3.1 begins. Research findings may adjust the implementation approach within Stories 3.1 and 3.2, but the epic plan and acceptance criteria remain sound.

## Readiness Assessment

| Area | Status | Notes |
| --- | --- | --- |
| Testing & Quality | ✅ Good | 213 tests passing, manual testing done, bugs caught and fixed |
| Deployment | N/A | Desktop app, dev mode — no production deployment needed yet |
| Stakeholder Acceptance | ✅ Accepted | Flow tested manually, phase graph looks and feels right |
| Technical Health | ✅ Solid | Code-simplifier passes keep it clean, design polish deferred intentionally |
| Unresolved Blockers | ✅ None | No blocking issues carrying forward |

## Next Epic Preview

**Epic 3: Agent Conversation Experience** — 6 stories (3.1–3.6)

- WebSocket streaming protocol, chat service, agent selection, chat panel, markdown renderer, thinking content display
- Significantly different problem domain: interactive real-time streaming vs read-only visualization
- Dependencies on Epic 2: WebSocket service (2.1), project open flow (2.1), activity bar chat placeholder (2.5)
- Three research spikes inform architecture before starting
- No significant discoveries requiring epic plan changes — implementation approach may adapt based on research

## Next Steps

1. Execute 3 research spikes (streaming conventions, Claude API access, Ollama test harness)
2. Complete housekeeping (story status alignment, epic-2 → done, retrospective → done)
3. Review research findings and confirm Epic 3 approach
4. Begin Epic 3 — start creating stories with SM agent's `create-story`

---

**Retrospective Status:** COMPLETE
**Document:** `_bmad-output/implementation-artifacts/epic-2-retro-2026-02-02.md`
